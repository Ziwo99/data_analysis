{
  "analyses": [
    {
      "id": "1",
      "title": "Demographic Analysis",
      "context": "Analyzing demographic attributes that impact loan approval likelihood.",
      "tables": [
        "credit_risk_dataset"
      ],
      "sub_analyses": [
        {
          "id": "1.1",
          "title": "Age Distribution",
          "why": "Understand the age distribution of loan applicants to identify target age groups for risk assessment.",
          "answers": [
            "Age brackets with highest loan applications"
          ],
          "tables_columns": [
            "credit_risk_dataset.person_age"
          ],
          "type": "distribution",
          "code_lines": [
            "# Group by age and count the number of occurrences",
            "result = credit_risk_dataset['person_age'].value_counts().reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['age', 'count']",
            "# Sort by age",
            "result = result.sort_values(by='age')"
          ]
        },
        {
          "id": "1.2",
          "title": "Income Analysis by Age",
          "why": "Determine the relationship between age and income to understand financial capabilities across different age groups.",
          "answers": [
            "Average income across age brackets"
          ],
          "tables_columns": [
            "credit_risk_dataset.person_age",
            "credit_risk_dataset.person_income"
          ],
          "type": "average_calculation",
          "code_lines": [
            "# Group by age and calculate mean income",
            "result = credit_risk_dataset.groupby('person_age')['person_income'].mean().reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['age', 'average_income']",
            "# Sort by age",
            "result = result.sort_values(by='age')"
          ]
        },
        {
          "id": "1.3",
          "title": "Home Ownership Status",
          "why": "Evaluate the distribution of home ownership statuses among applicants to assess stability factors.",
          "answers": [
            "Proportion of different home ownership statuses"
          ],
          "tables_columns": [
            "credit_risk_dataset.person_home_ownership"
          ],
          "type": "categorical_distribution",
          "code_lines": [
            "# Count each home ownership status",
            "result = credit_risk_dataset['person_home_ownership'].value_counts(normalize=True).reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['home_ownership_status', 'proportion']"
          ]
        }
      ]
    },
    {
      "id": "2",
      "title": "Employment Analysis",
      "context": "Evaluate employment factors and their impact on loan outcomes.",
      "tables": [
        "credit_risk_dataset"
      ],
      "sub_analyses": [
        {
          "id": "2.1",
          "title": "Employment Length Distribution",
          "why": "Identify typical employment lengths among loan applicants to measure consistency in employment.",
          "answers": [
            "Employment length distribution in years"
          ],
          "tables_columns": [
            "credit_risk_dataset.person_emp_length"
          ],
          "type": "distribution",
          "code_lines": [
            "# Group by employment length and count occurrences",
            "result = credit_risk_dataset['person_emp_length'].value_counts().reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['employment_length', 'count']",
            "# Sort by employment length",
            "result = result.sort_values(by='employment_length')"
          ]
        },
        {
          "id": "2.2",
          "title": "Employment Length and Loan Approval",
          "why": "Determine the correlation between employment length and loan approval rates.",
          "answers": [
            "Loan approval rates across different employment lengths"
          ],
          "tables_columns": [
            "credit_risk_dataset.person_emp_length",
            "credit_risk_dataset.loan_status"
          ],
          "type": "correlation",
          "code_lines": [
            "# Group by employment length and loan status, then calculate the mean approval rate",
            "result = credit_risk_dataset.groupby('person_emp_length')['loan_status'].mean().reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['employment_length', 'approval_rate']"
          ]
        }
      ]
    },
    {
      "id": "3",
      "title": "Loan Analysis",
      "context": "Examine factors directly related to loan applications and conditions.",
      "tables": [
        "credit_risk_dataset"
      ],
      "sub_analyses": [
        {
          "id": "3.1",
          "title": "Loan Amount Distribution",
          "why": "Ascertain the common loan amounts requested to understand market demand.",
          "answers": [
            "Distribution of loan amounts"
          ],
          "tables_columns": [
            "credit_risk_dataset.loan_amnt"
          ],
          "type": "distribution",
          "code_lines": [
            "# Group by loan amount and count occurrences",
            "result = credit_risk_dataset['loan_amnt'].value_counts().reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['loan_amount', 'count']",
            "# Sort by loan amount",
            "result = result.sort_values(by='loan_amount')"
          ]
        },
        {
          "id": "3.2",
          "title": "Interest Rate Analysis",
          "why": "Investigate interest rate trends among approved loans for cost analysis.",
          "answers": [
            "Average interest rates for approved loans"
          ],
          "tables_columns": [
            "credit_risk_dataset.loan_int_rate",
            "credit_risk_dataset.loan_status"
          ],
          "type": "average_calculation",
          "code_lines": [
            "# Filter for only approved loans",
            "approved_loans = credit_risk_dataset[credit_risk_dataset['loan_status'] == 1]",
            "# Calculate the mean interest rate",
            "result = approved_loans['loan_int_rate'].mean()",
            "# Convert result to DataFrame",
            "result = pd.DataFrame({'average_interest_rate': [result]})"
          ]
        },
        {
          "id": "3.3",
          "title": "Loan Purpose Analysis",
          "why": "Evaluate the distribution of loan intents to ascertain primary borrowing motivators.",
          "answers": [
            "Loan purpose proportions"
          ],
          "tables_columns": [
            "credit_risk_dataset.loan_intent"
          ],
          "type": "categorical_distribution",
          "code_lines": [
            "# Count each loan intent",
            "result = credit_risk_dataset['loan_intent'].value_counts(normalize=True).reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['loan_intent', 'proportion']"
          ]
        }
      ]
    },
    {
      "id": "4",
      "title": "Credit Risk Assessment",
      "context": "Analyze credit-related factors affecting risk and loan decisions.",
      "tables": [
        "credit_risk_dataset"
      ],
      "sub_analyses": [
        {
          "id": "4.1",
          "title": "Default History Impact",
          "why": "Examine how historical defaults affect loan approval rates.",
          "answers": [
            "Loan approval rates with and without historical defaults"
          ],
          "tables_columns": [
            "credit_risk_dataset.cb_person_default_on_file",
            "credit_risk_dataset.loan_status"
          ],
          "type": "correlation",
          "code_lines": [
            "# Group by default history and loan status, then calculate the mean approval rate",
            "result = credit_risk_dataset.groupby('cb_person_default_on_file')['loan_status'].mean().reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['default_status', 'approval_rate']"
          ]
        },
        {
          "id": "4.2",
          "title": "Credit History Length",
          "why": "Assess how credit history length influences creditworthiness.",
          "answers": [
            "Loan approval rates against credit history length"
          ],
          "tables_columns": [
            "credit_risk_dataset.cb_person_cred_hist_length",
            "credit_risk_dataset.loan_status"
          ],
          "type": "correlation",
          "code_lines": [
            "# Group by credit history length and loan status, then calculate the mean approval rate",
            "result = credit_risk_dataset.groupby('cb_person_cred_hist_length')['loan_status'].mean().reset_index()",
            "# Rename columns for clarity",
            "result.columns = ['credit_hist_length', 'approval_rate']",
            "# Sort by credit history length",
            "result = result.sort_values(by='credit_hist_length')"
          ]
        }
      ]
    }
  ]
}